var _0x2e39=['标签高度：','height','center','canvasGetImageData','setTextAlign','startScanPeripherals','push','width','setFillStyle','left','toUpperCase','qrcode','DPI','globalData','log','restore','./BitmapPackage.js','translate','white','drawImage','arrayWithImage','draw','rotate','标签宽度：','fillText','sort','sendData','strokeRect','RSSI','exports','substring','currentPrinter','data','disconnectPeripheral','name','fillRect','canvasId','right'];var _0x2a53=function(_0x2e3964,_0x2a5373){_0x2e3964=_0x2e3964-0x0;var _0x347266=_0x2e39[_0x2e3964];return _0x347266;};var dzBLE=require('./DzBLE.js');var bitmapPackage=require(_0x2a53('0x10'));var barcodeWriter=require('./BarcodeWriter.js');var printWidth=0x0;var printHeight=0x0;var printOrientation=0x0;var itemOrientation=0x0;var itemHorizontalAlignment=0x0;var itemVerticalAlignment=0x0;var connectPrinterTimer;var canConnect=!![];var printPageGapType=-0x1;var printPageGapLength=0x2;var printDarkness=0x0;var printSpeed=0x0;var hasInit=![];var canvas=null;var canvasJS=null;var filePath=null;var isConnecting=![];function covert(_0x5f5458){_0x5f5458=_0x5f5458*DPI()/25.4;_0x5f5458=_0x5f5458>=0x0?_0x5f5458+0.1:_0x5f5458-0.1;return parseInt(_0x5f5458);}function DPI(){var _0x19dbaa=getApp()['globalData'][_0x2a53('0x1f')];var _0x34c7db=_0x19dbaa[_0x2a53('0xc')];return _0x34c7db;}function setPrintPageGapType(_0x4d97ab){printPageGapType=_0x4d97ab;}function setPrintPageGapLength(_0x251972){printPageGapLength=_0x251972;}function setPrintDarkness(_0x456e52){printDarkness=_0x456e52;}function setPrintSpeed(_0x159f21){printSpeed=_0x159f21;}function setSupportPrefixs(_0x432bf4){dzBLE['setSupportPrefixs'](_0x432bf4);}function connectingPrinterName(){var _0x1da4ff=getApp()[_0x2a53('0xd')]['currentPrinter'];return _0x1da4ff[_0x2a53('0x22')];}function initLPAPI(){isConnecting=![];hasInit=![];}function initPrinterCenter(_0x118816){if(hasInit){dzBLE[_0x2a53('0x5')](function(_0x52771c){if(_0x118816){_0x118816(_0x52771c);}});}else{dzBLE['initBLE'](function(_0x21082a){hasInit=!![];if(_0x118816){_0x118816(_0x21082a);}});}}function scanedPrinters(_0xf2dd54){initPrinterCenter(function(_0x3f96e7){if(_0xf2dd54){_0xf2dd54(_0x3f96e7);}});}function compare(_0x5815ba){return function(_0x40e916,_0x397560){var _0x3ee50b=_0x40e916[_0x5815ba];var _0x1a1aac=_0x397560[_0x5815ba];return _0x1a1aac-_0x3ee50b;};}function openPrinter(_0x3cdf9d,_0x51e1dc,_0x117493){if(isConnecting){if(_0x51e1dc){_0x51e1dc();}return;}initPrinterCenter(function(_0x28a85c){var _0x8e29fd=null;if(_0x28a85c['length']>0x0){if(_0x3cdf9d==null||_0x3cdf9d['length']==0x0){_0x28a85c[_0x2a53('0x19')](compare(_0x2a53('0x1c')));_0x8e29fd=_0x28a85c[0x0]['deviceId'];}else{for(var _0xff7ffb=0x0;_0xff7ffb<_0x28a85c['length'];_0xff7ffb++){var _0x34f2a3=_0x28a85c[_0xff7ffb];var _0x4ca27b=_0x34f2a3[_0x2a53('0x22')][_0x2a53('0x1e')](0x0,_0x3cdf9d['length']);if(_0x4ca27b[_0x2a53('0xa')]()==_0x3cdf9d['toUpperCase']()){_0x8e29fd=_0x34f2a3['deviceId'];break;}}}dzBLE['connectPeripheral'](_0x8e29fd,function(){isConnecting=!![];if(_0x51e1dc){_0x51e1dc();}},function(){isConnecting=![];if(_0x117493){_0x117493();}});}else{}});}function connectingPrinterDetailInfos(){var _0x3c31b2=getApp()[_0x2a53('0xd')][_0x2a53('0x1f')];return _0x3c31b2;}function closePrinter(){dzBLE[_0x2a53('0x21')]();}function startDrawLabel(_0x3adf35,_0x498266,_0x2c182e,_0x3a6535,_0x4ef4aa){canvas=wx['createCanvasContext'](_0x3adf35);if(canvas==null){}else{printOrientation=_0x4ef4aa;printWidth=covert(_0x2c182e);printHeight=covert(_0x3a6535);itemOrientation=0x0;itemHorizontalAlignment=0x0;itemVerticalAlignment=0x0;canvasJS=_0x498266;canvas['clearRect'](0x0,0x0,canvas['width'],canvas[_0x2a53('0x1')]);canvas['draw']();canvasJS['setData']({'canvasWidth':printWidth,'canvasHeight':printHeight});canvas[_0x2a53('0x8')](_0x2a53('0x12'));canvas['fillRect'](0x0,0x0,printWidth+0x5,printHeight+0x5);canvas[_0x2a53('0x8')]('black');}}function endDrawLabel(_0x5dce33){canvas[_0x2a53('0x15')](!![],setTimeout(function(){if(printOrientation==0x0){if(_0x5dce33){_0x5dce33();}}else{wx[_0x2a53('0x3')]({'canvasId':canvas[_0x2a53('0x24')],'x':0x0,'y':0x0,'width':printWidth,'height':printHeight,'success'(_0x25ea8a){var _0x508599=_0x25ea8a[_0x2a53('0x20')];var _0x50dd90=new Array();if(printOrientation==0x5a){for(var _0x239aa8=printWidth-0x1;_0x239aa8>=0x0;_0x239aa8--){for(var _0x14be4b=0x0;_0x14be4b<printHeight;_0x14be4b++){var _0x1bb8c6=(printWidth*_0x14be4b+_0x239aa8)*0x4;_0x50dd90[_0x2a53('0x6')](_0x508599[_0x1bb8c6+0x0]);_0x50dd90['push'](_0x508599[_0x1bb8c6+0x1]);_0x50dd90['push'](_0x508599[_0x1bb8c6+0x2]);_0x50dd90['push'](_0x508599[_0x1bb8c6+0x3]);}}var _0x39e97c=printWidth;printWidth=printHeight;printHeight=_0x39e97c;}else if(printOrientation==0xb4){for(var _0x14be4b=printHeight-0x1;_0x14be4b>=0x0;_0x14be4b--){for(var _0x239aa8=printWidth-0x1;_0x239aa8>=0x0;_0x239aa8--){var _0x1bb8c6=(printWidth*_0x14be4b+_0x239aa8)*0x4;_0x50dd90[_0x2a53('0x6')](_0x508599[_0x1bb8c6+0x0]);_0x50dd90['push'](_0x508599[_0x1bb8c6+0x1]);_0x50dd90[_0x2a53('0x6')](_0x508599[_0x1bb8c6+0x2]);_0x50dd90[_0x2a53('0x6')](_0x508599[_0x1bb8c6+0x3]);}}}else if(printOrientation==0x10e){for(var _0x239aa8=0x0;_0x239aa8<printWidth;_0x239aa8++){for(var _0x14be4b=printHeight-0x1;_0x14be4b>=0x0;_0x14be4b--){var _0x1bb8c6=(printWidth*_0x14be4b+_0x239aa8)*0x4;_0x50dd90['push'](_0x508599[_0x1bb8c6+0x0]);_0x50dd90['push'](_0x508599[_0x1bb8c6+0x1]);_0x50dd90['push'](_0x508599[_0x1bb8c6+0x2]);_0x50dd90[_0x2a53('0x6')](_0x508599[_0x1bb8c6+0x3]);}}var _0x39e97c=printWidth;printWidth=printHeight;printHeight=_0x39e97c;}canvasJS['setData']({'canvasWidth':printWidth,'canvasHeight':printHeight});var _0x551c8d=new Uint8ClampedArray(_0x50dd90);wx['canvasPutImageData']({'canvasId':canvas['canvasId'],'data':_0x551c8d,'x':0x0,'y':0x0,'width':printWidth,'height':printHeight,'success'(_0x3101ac){if(_0x5dce33){_0x5dce33();}},'fail'(_0x2d90fa){console[_0x2a53('0xe')](_0x2d90fa);}});}});}},0x3e8));}function print(_0x21c4fb){wx['canvasGetImageData']({'canvasId':canvas[_0x2a53('0x24')],'x':0x0,'y':0x0,'width':printWidth,'height':printHeight,'success'(_0x4da865){console[_0x2a53('0xe')](_0x2a53('0x17')+_0x4da865[_0x2a53('0x7')]);console[_0x2a53('0xe')](_0x2a53('0x0')+_0x4da865[_0x2a53('0x1')]);var _0x2214c1=bitmapPackage[_0x2a53('0x14')](_0x4da865[_0x2a53('0x20')],_0x4da865['width'],_0x4da865[_0x2a53('0x1')],printPageGapType,printPageGapLength*0x64,printDarkness,printSpeed,![]);dzBLE[_0x2a53('0x1a')](_0x2214c1,function(){if(_0x21c4fb){_0x21c4fb();}});}});}function setItemOrientation(_0x44c724){if(_0x44c724!=0x0&&_0x44c724!=0x5a&&_0x44c724!=0xb4&&_0x44c724!=0x10e){return;}itemOrientation=_0x44c724;}function setItemHorizontalAlignment(_0x320646){if(_0x320646!=0x0&&_0x320646!=0x1&&_0x320646!=0x2){return;}itemHorizontalAlignment=_0x320646;}function setItemVerticalAlignment(_0x48061c){if(_0x48061c!=0x0&&_0x48061c!=0x1&&_0x48061c!=0x2){return;}itemVerticalAlignment=_0x48061c;}function drawText(_0x2a87dd,_0xd7ac1f,_0x4a75c9,_0x1314e4){canvas['setFontSize'](covert(_0x1314e4));switch(itemHorizontalAlignment){case 0x0:{canvas[_0x2a53('0x4')](_0x2a53('0x9'));break;}case 0x1:{canvas[_0x2a53('0x4')](_0x2a53('0x2'));break;}case 0x2:{canvas[_0x2a53('0x4')](_0x2a53('0x25'));break;}default:break;}canvas[_0x2a53('0x18')](_0x2a87dd,covert(_0xd7ac1f),covert(_0x4a75c9));}function drawBarcode(_0x5cfa38,_0x3df154,_0xcffeb1,_0xdae43a,_0x4c5218){_0x3df154=covert(_0x3df154);_0xcffeb1=covert(_0xcffeb1);_0xdae43a=covert(_0xdae43a);_0x4c5218=covert(_0x4c5218);canvas['save']();switch(itemOrientation){case 0x1:case 0x5a:{canvas['rotate'](Math['PI']/0x2);canvas[_0x2a53('0x11')](parseInt(_0xcffeb1-_0x3df154),parseInt(-_0x3df154-_0xcffeb1-_0xdae43a));var _0x41b953=_0xdae43a;_0xdae43a=_0x4c5218;_0x4c5218=_0x41b953;break;}case 0x2:case 0xb4:{canvas['rotate'](Math['PI']);canvas[_0x2a53('0x11')](parseInt(-_0x3df154*0x2-_0xdae43a),parseInt(-_0xcffeb1*0x2-_0x4c5218));break;}case 0x3:case 0x10e:{canvas['rotate'](-Math['PI']/0x2);canvas[_0x2a53('0x11')](parseInt(-_0x3df154-_0xcffeb1-_0x4c5218),parseInt(_0x3df154-_0xcffeb1));var _0x41b953=_0xdae43a;_0xdae43a=_0x4c5218;_0x4c5218=_0x41b953;break;}default:break;}barcodeWriter['barcode'](canvas,_0x5cfa38,_0x3df154,_0xcffeb1,_0xdae43a,_0x4c5218);canvas[_0x2a53('0xf')]();}function drawQRCode(_0x3799ee,_0x4a363a,_0x19191c,_0x238c03,_0x4782c2){_0x4a363a=covert(_0x4a363a);_0x19191c=covert(_0x19191c);_0x238c03=covert(_0x238c03);_0x4782c2=covert(_0x4782c2);canvas['save']();switch(itemOrientation){case 0x1:case 0x5a:{canvas['rotate'](Math['PI']/0x2);canvas[_0x2a53('0x11')](parseInt(_0x19191c-_0x4a363a),parseInt(-_0x4a363a-_0x19191c-_0x238c03));var _0x52a4c3=_0x238c03;_0x238c03=_0x4782c2;_0x4782c2=_0x52a4c3;break;}case 0x2:case 0xb4:{canvas[_0x2a53('0x16')](Math['PI']);canvas['translate'](parseInt(-_0x4a363a*0x2-_0x238c03),parseInt(-_0x19191c*0x2-_0x4782c2));break;}case 0x3:case 0x10e:{canvas[_0x2a53('0x16')](-Math['PI']/0x2);canvas[_0x2a53('0x11')](parseInt(-_0x4a363a-_0x19191c-_0x4782c2),parseInt(_0x4a363a-_0x19191c));var _0x52a4c3=_0x238c03;_0x238c03=_0x4782c2;_0x4782c2=_0x52a4c3;break;}default:break;}barcodeWriter[_0x2a53('0xb')](canvas,_0x3799ee,_0x4a363a,_0x19191c,_0x238c03,_0x4782c2);canvas[_0x2a53('0xf')]();}function drawLine(_0x4a0e04,_0x2d2839,_0x29207a,_0x155e50){drawRectangle(_0x4a0e04,_0x2d2839,_0x29207a,_0x155e50,0x0,!![]);}function drawRectangle(_0x4a48e7,_0x286b50,_0x53c690,_0x5ae5a3,_0x12d4b0,_0x55d83a){_0x4a48e7=covert(_0x4a48e7);_0x286b50=covert(_0x286b50);_0x53c690=covert(_0x53c690);_0x5ae5a3=covert(_0x5ae5a3);_0x12d4b0=covert(_0x12d4b0);canvas['save']();switch(itemOrientation){case 0x1:case 0x5a:{canvas[_0x2a53('0x16')](Math['PI']/0x2);canvas[_0x2a53('0x11')](parseInt(_0x286b50-_0x4a48e7),parseInt(-_0x4a48e7-_0x286b50-_0x53c690));var _0x3af0f5=_0x53c690;_0x53c690=_0x5ae5a3;_0x5ae5a3=_0x3af0f5;break;}case 0x2:case 0xb4:{canvas[_0x2a53('0x16')](Math['PI']);canvas['translate'](parseInt(-_0x4a48e7*0x2-_0x53c690),parseInt(-_0x286b50*0x2-_0x5ae5a3));break;}case 0x3:case 0x10e:{canvas[_0x2a53('0x16')](-Math['PI']/0x2);canvas['translate'](parseInt(-_0x4a48e7-_0x286b50-_0x5ae5a3),parseInt(_0x4a48e7-_0x286b50));var _0x3af0f5=_0x53c690;_0x53c690=_0x5ae5a3;_0x5ae5a3=_0x3af0f5;break;}default:break;}canvas['setLineWidth'](_0x12d4b0);if(_0x55d83a){canvas[_0x2a53('0x8')]('black');canvas[_0x2a53('0x23')](_0x4a48e7,_0x286b50,_0x53c690,_0x5ae5a3);}else{canvas[_0x2a53('0x1b')](_0x4a48e7,_0x286b50,_0x53c690,_0x5ae5a3);}canvas['restore']();}function drawImage(_0x2a3c6a,_0x5bfb9f,_0x26d5ae,_0x5d5a93,_0x29429b){_0x5bfb9f=covert(_0x5bfb9f);_0x26d5ae=covert(_0x26d5ae);_0x5d5a93=covert(_0x5d5a93);_0x29429b=covert(_0x29429b);canvas[_0x2a53('0x13')](_0x2a3c6a,_0x5bfb9f,_0x26d5ae,_0x5d5a93,_0x29429b);}module[_0x2a53('0x1d')]={'setPrintPageGapType':setPrintPageGapType,'setPrintPageGapLength':setPrintPageGapLength,'setPrintDarkness':setPrintDarkness,'setPrintSpeed':setPrintSpeed,'setSupportPrefixs':setSupportPrefixs,'connectingPrinterName':connectingPrinterName,'scanedPrinters':scanedPrinters,'openPrinter':openPrinter,'initLPAPI':initLPAPI,'connectingPrinterDetailInfos':connectingPrinterDetailInfos,'closePrinter':closePrinter,'startDrawLabel':startDrawLabel,'endDrawLabel':endDrawLabel,'print':print,'setItemOrientation':setItemOrientation,'setItemHorizontalAlignment':setItemHorizontalAlignment,'setItemVerticalAlignment':setItemVerticalAlignment,'drawText':drawText,'drawBarcode':drawBarcode,'drawQRCode':drawQRCode,'drawLine':drawLine,'drawRectangle':drawRectangle,'drawImage':drawImage};